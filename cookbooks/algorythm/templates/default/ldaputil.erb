#!/bin/bash

USER="dirmanager"
PASS="password"
BASE_DN="dc=dev,dc=algorythm,dc=de"
DOMAIN="dev.algorythm.de"
MAIL_FORWARDING_ADDRESS="admin@dev.algorythm.de"

case "$1" in
  addsystem)
SYSTEM=$2
echo "dn: cn=$SYSTEM,ou=Special Users,$BASE_DN
objectClass: glue
objectClass: top
objectClass: mailRecipient
objectClass: simpleSecurityObject
cn: $SYSTEM
mail: no-reply@$SYSTEM.$DOMAIN
mailForwardingAddress: $MAIL_FORWARDING_ADDRESS
userPassword:: e3NzaGE1MTJ9akxpY2FJMXkzZlpGS1RHamQ1SFlvcWN0TXNyQVpidFo2Tk5OY
 zIvalNWa1RUYkZ0OFc3YzRLUFROWFlyTjhQNC9lZmN4MVAvUTJEdnBHNlRFS2I1NG1oL0F3MHB1
 WUU2
" | ldapmodify -a -x -h localhost -p 389 -D cn=$USER -w "$PASS"
        ;;
  *)
        echo "Usage: $0 {addsystem}" >&2
        exit 3
        ;;
esac

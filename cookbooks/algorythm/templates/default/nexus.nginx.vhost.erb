server {
	listen 80;
	server_name <%=@hostname%>;
	root /usr/share/nginx/www;

	access_log /var/log/nginx/nexus-proxy-access;
	error_log  /var/log/nginx/nexus-proxy-error;

	rewrite ^ https://<%=@hostname%>$request_uri permanent;
}

server {
	listen 443 ssl;
	server_name <%=@hostname%>;
	root /usr/share/nginx/www;

	access_log /var/log/nginx/nexus-proxy-access;
	error_log  /var/log/nginx/nexus-proxy-error;

	ssl_certificate     /etc/ssl/certs/ssl-cert-snakeoil.pem;
	ssl_certificate_key /etc/ssl/private/ssl-cert-snakeoil.key;

	include proxy_params;

	location /nexus {
		proxy_pass http://127.0.0.1:<%=@https_port%>/nexus;
	}

	location / {
		rewrite ^ /nexus$request_uri permanent;
	}
}
